<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{base::layout(~{::section})}">

<head>
	<meta charset="UTF-8">

	<title th:text="${title}">View Book</title>

</head>

<body>
	<section class="hero-section position-relative padding-large"
		style="background-image: url(/images/banner-image-bg-1.jpg); background-size: cover; background-repeat: no-repeat; background-position: center; height: 400px;">
		<div class="hero-content">
			<div class="container">
				<div class="row">
					<div class="text-center">
						<h1>Chi tiết sách</h1>
						<div class="breadcrumbs">
							<span class="item">
								<a href="index.html">Trang chủ > </a>
							</span>
							<span class="item text-decoration-underline">Chi tiết sách</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<section class="single-product padding-large">
		<div class="container">
			<div class="row">
				<th:block th:if="${session.succMsg}">
					<p class="text-success alert alert-success text-center" role="alert">[[${session.succMsg}]]</p>
					<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
				</th:block>

				<th:block th:if="${session.errorMsg}">
					<p class="text-danger text-center  alert alert-danger">[[${session.errorMsg}]]</p>
					<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>

				</th:block>
				<div class="col-lg-6">
					<div class="d-flex gap-3 product-preview">
						<div class="swiper thumb-swiper w-50">
							<div class="swiper-wrapper d-flex flex-wrap gap-3 align-content-start">
								<!--<div class="swiper-slide bg-white">
																		<img th:src="@{'/images/book_img/'+${book.image}}" alt="product-thumb" class="img-fluid border rounded-3">-->
								<!--									<img th:src="@{${book.image != null && book.image.startsWith('http') ? book.image : '/images/book_img/' + book.image}}" alt="product-thumb" class="img-fluid border rounded-3">-->
								<!--									<img th:src="${book.image != null && book.image.startsWith('http') ? book.image : '/images/book_img/' + ${book.image}}"-->
								<!--										 alt="product-thumb" class="img-fluid border rounded-3">-->
								<!--<img th:src="${book.image != null and book.image.startsWith('http') ? book.image : '/images/book_img/' + book.image}"
										alt="product-thumb" class="img-fluid border rounded-3">
								</div>

								<div class="swiper-slide bg-white">
									<img src="/images/product-thumbnail-2.png" alt="product-thumb"
										class="img-fluid border rounded-3">
								</div>

								<div class="swiper-slide bg-white">
									<img src="/images/product-thumbnail-3.png" alt="product-thumb"
										class="img-fluid border rounded-3">
								</div>-->
							</div>
						</div>
						<div class="swiper large-swiper border rounded-3 overflow-hidden">
							<div class="swiper-wrapper">
								<div class="swiper-slide bg-white">
									<!--									<img th:src="@{'/images/book_img/'+${book.image}}" alt="single-product" class="img-fluid">-->
									<img th:src="@{${book.image != null && book.image.startsWith('http') ? book.image : '/images/book_img/' + book.image}}"
										alt="single-product" class="img-fluid" style="height: 100%;">
								</div>
								<div class="swiper-slide bg-white">
									<img src="/images/product-large-2.png" alt="single-product" class="img-fluid">
								</div>
								<div class="swiper-slide bg-white">
									<img src="/images/product-large-3.png" alt="single-product" class="img-fluid">
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-6">
					<div class="product-info ps-lg-5 pt-3 pt-lg-0">
						<div class="element-header">
							<h1 class="product-title">[[${book.bookName}]]</h1>
							<div class="product-price d-flex align-items-center mt-2">
								<span class="fs-2 fw-light text-primary me-2">[[${book.discountPrice}]]đ</span>
								<del>[[${book.price}]]đ</del>
							</div>
							<div class="rating-container" th:attr="data-rating=${book.averageRating}">
								<div class="rating">
									<span class="rating-unit "><i class="fa-solid fa-star"
											style="font-size: 15px;"></i></span>
									<span class="rating-unit "><i class="fa-solid fa-star"
											style="font-size: 15px;"></i></span>
									<span class="rating-unit "><i class="fa-solid fa-star"
											style="font-size: 15px;"></i></span>
									<span class="rating-unit "><i class="fa-solid fa-star"
											style="font-size: 15px;"></i></span>
									<span class="rating-unit "><i class="fa-solid fa-star"
											style="font-size: 15px;"></i></span>
								</div>
							</div>
						</div>
						<p style="display: flex; justify-content: space-between; align-items: center;">
													<span>Tác giả: [[${book.author}]].</span>
													<span style="margin-left: auto;">Đã bán: [[${book.sold}]]</span>
												</p>
						<hr>
						<div class="cart-wrap">

							<div class="product-quantity my-3">
								<div class="item-title">
									<l>Chọn số lượng:</l>
								</div>
								<div class="stock-button-wrap mt-2 d-flex flex-wrap align-items-center">
									<div class="product-quantity">
										<div class="input-group product-qty align-items-center"
											style="max-width: 150px;">
											<span class="input-group-btn">
												<button type="button"
													class="bg-white shadow border rounded-3 fw-light quantity-left-minus"
													data-type="minus" data-field="">
													<i class="fa-solid fa-minus"></i>
												</button>
											</span>
											<input type="text" id="quantity" name="quantity"
												class="form-control bg-white shadow border rounded-3 py-2 mx-2 input-number text-center"
												value="1" min="1" max="100" required>
											<span class="input-group-btn">
												<button type="button"
													class="bg-white shadow border rounded-3 fw-light quantity-right-plus"
													data-type="plus" data-field="">
													<i class="fa-solid fa-plus"></i>
												</button>
											</span>
										</div>
									</div>
								</div>
							</div>
							<div class="action-buttons my-3 d-flex flex-wrap gap-3">
								<!--<a href="#" class="btn">Order now</a>-->
								<th:block th:if="${book.stock>0}">
									<th:block th:if="${user==null}">
										<a href="/signin" class="btn btn-dark">Thêm giỏ hàng</a>
									</th:block>
									<th:block th:unless="${user==null}">
										<a th:href="@{'/user/addCart?pid='+${book.id}+'&uid='+${user.id}}"
											class="btn btn-dark">Thêm giỏ hàng</a>
									</th:block>
								</th:block>
								<th:block th:unless="${book.stock>0}">
									<a href="#" class="btn btn-dark">Sách tạm hết</a>
								</th:block>
								<th:block th:if="${user==null}">
									<a href="/signin" class="btn btn-dark">
										<svg class="heart" width="21" height="21">
											<use xlink:href="#heart"></use>
										</svg>
									</a>
								</th:block>
								<th:block th:unless="${user==null}">
									<a th:href="@{'/user/addWishList?pid='+${book.id}+'&uid='+${user.id}}"
										class="btn btn-dark">
										<svg class="heart" width="21" height="21">
											<use xlink:href="#heart"></use>
										</svg>
									</a>
								</th:block>
								<!--	<a th:href="@{'/user/addWishList?pid='+${book.id}+'&uid='+${user.id}}"
									class="btn btn-dark">
									<svg class="heart" width="21" height="21">
										<use xlink:href="#heart"></use>
									</svg>
								</a>-->
								<form th:action="@{/book/{id}/review(id=${book.id})}" method="post">
									<button class="btn btn-dark" type="submit">Đánh giá sách</button>
								</form>
							</div>
						</div>
						<hr>
						<div class="meta-product my-3">
							<div class="meta-item d-flex mb-1">
								<span class="fw-medium me-2">Số lượng: </span>
								<ul class="select-list list-unstyled d-flex mb-0">
									<li data-value="S" class="select-item">[[${book.stock}]]</li>
								</ul>
							</div>
							<div class="meta-item d-flex mb-1">
								<span class="fw-medium me-2">Danh mục:</span>
								<ul class="select-list list-unstyled d-flex mb-0">
									<li data-value="S" class="select-item">
										<a href="#">[[${book.category}]]</a>
									</li>

								</ul>
							</div>
							<div class="meta-item d-flex mb-1">
								<span class="fw-medium me-2">Nhà xuất bản:</span>
								<ul class="select-list list-unstyled d-flex mb-0">
									<li data-value="S" class="select-item">
										<a href="#">[[${book.publisher}]]</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	
	<section class="product-tabs">
	     <div class="container">
	       <div class="row">
	         <div class="tabs-listing">
	           <nav>
	             <div class="nav nav-tabs d-flex justify-content-center py-3" id="nav-tab" role="tablist">
	               <button class="nav-link text-capitalize active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Description</button>
	            
	               <button class="nav-link text-capitalize" id="nav-shipping-tab" data-bs-toggle="tab" data-bs-target="#nav-shipping" type="button" role="tab" aria-controls="nav-shipping" aria-selected="false">Shipping & Return</button>
	              
	             </div>
	           </nav>
	           <div class="tab-content border-bottom py-4" id="nav-tabContent">
	             <div class="tab-pane fade active show" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
	               <div th:utext="${book.description}"></div>
	             <!--  <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec odio. Quisque volutpat mattis eros. Nullam malesuada erat ut turpis. Suspendisse urna viverra non, semper suscipit, posuere a, pede. Donec nec justo eget felis facilisis fermentum. Aliquam porttitor mauris sit amet orci. Aenean dignissim pellentesque felis. Phasellus ultrices nulla quis nibh. Quisque a lectus. Donec consectetuer ligula vulputate sem tristique cursus.
	               <ul class="fw-light">
	                 <li>Donec nec justo eget felis facilisis fermentum.</li>
	                 <li>Suspendisse urna viverra non, semper suscipit pede.</li>
	                 <li>Aliquam porttitor mauris sit amet orci.</li>
	               </ul>
	               <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Donec odio. Quisque volutpat mattis eros. Nullam malesuada erat ut turpis. Suspendisse urna viverra non, semper suscipit, posuere a, pede. Donec nec justo eget felis facilisis fermentum. Aliquam porttitor mauris sit amet orci. Aenean dignissim pellentesque felis. Phasellus ultrices nulla quis nibh. Quisque a lectus. Donec consectetuer ligula vulputate sem tristique cursus.</p>
	             </div>
	             
	             <div class="tab-pane fade" id="nav-shipping" role="tabpanel" aria-labelledby="nav-shipping-tab">
	               <p>Returns Policy</p>
	               <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce eros justo, accumsan non dui sit amet. Phasellus semper volutpat mi sed imperdiet. Ut odio lectus, vulputate non ex non, mattis sollicitudin purus. Mauris consequat justo a enim interdum, in consequat dolor accumsan. Nulla iaculis diam purus, ut vehicula leo efficitur at.</p>
	               <p>Interdum et malesuada fames ac ante ipsum primis in faucibus. In blandit nunc enim, sit amet pharetra erat aliquet ac.</p>
	               <p>Shipping</p>
	               <p>Pellentesque ultrices ut sem sit amet lacinia. Sed nisi dui, ultrices ut turpis pulvinar. Sed fringilla ex eget lorem consectetur, consectetur blandit lacus varius. Duis vel scelerisque elit, et vestibulum metus. Integer sit amet tincidunt tortor. Ut lacinia ullamcorper massa, a fermentum arcu vehicula ut. Ut efficitur faucibus dui Nullam tristique dolor eget turpis consequat varius. Quisque a interdum augue. Nam ut nibh mauris.</p>
	             </div>-->
	           	</div>
	       	</div>
	     </div>
	</section>

	<section class="comments-section padding-large">
		<div class="container">
			<h3 class="mb-4">Bình luận</h3>

			<!-- Hiển thị danh sách bình luận -->
			<ul class="list-unstyled">
				<li th:each="comment : ${comments}">
					<div class="card mb-3 shadow-sm">
						<div class="card-body">
							<h5 class="card-title mb-1" th:text="${comment.user.name}">User</h5>
							<p class="card-text text-muted mb-2">
								<small
									th:text="${#temporals.format(comment.commentDate, 'dd/MM/yyyy HH:mm')}">Date</small>
							</p>
							<p class="card-text" th:text="${comment.content}">Comment content</p>

							<!-- Hiển thị các câu trả lời cho bình luận -->
							<!--							<div class="ms-4 mt-3">-->
							<!--								<h6 class="text-secondary">Phản hồi</h6>-->
							<!--								<ul class="list-unstyled">-->
							<!--									<li th:each="reply : ${comment.replies}">-->
							<!--										<div class="border-start ps-3 mb-3">-->
							<!--											<h6 class="mb-1" th:text="${reply.user.name}">User</h6>-->
							<!--											<p class="text-muted mb-1">-->
							<!--												<small th:text="${#temporals.format(reply.commentDate, 'dd/MM/yyyy HH:mm')}">Date</small>-->
							<!--											</p>-->
							<!--											<p class="mb-0" th:text="${reply.content}">Reply content</p>-->
							<!--										</div>-->
							<!--									</li>-->
							<!--								</ul>-->
							<!--							</div>-->

							<!-- Nút trả lời bình luận -->
							<!--							<button class="btn btn-sm btn-outline-primary mt-2" th:data-comment-id="${comment.id}">-->
							<!--								Trả lời-->
							<!--							</button>-->
						</div>
					</div>
				</li>
			</ul>

			<!-- Form thêm bình luận -->
			<div class="mt-4">
				<h4 class="mb-3">Thêm bình luận</h4>
				<form th:action="@{/book/{bookId}(bookId=${book.id})}" method="post">
					<div class="form-group mb-3">
						<textarea class="form-control" name="content" rows="3" placeholder="Nhập bình luận của bạn"
							required></textarea>
					</div>
					<input type="hidden" name="userId" th:value="${user != null ? user.id : ''}" />
					<button class="btn btn-primary" type="submit">Gửi</button>
				</form>
			</div>
		</div>
	</section>



</body>

</html>